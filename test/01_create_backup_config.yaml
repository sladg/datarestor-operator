apiVersion: v1
kind: Namespace
metadata:
  name: backup-test-config
---
apiVersion: backup.datarestor-operator.com/v1alpha1
kind: Config
metadata:
  name: restic-backups
  namespace: backup-test-config
spec:
  autoRestore: true
  stopPods: true

  selectors:
    - matchNamespaces:
        - backup-test-sqlite
        - default
    - matchLabels:
        backup: "true"

  repositories:
    - target: s3:http://minio.backup-test:9000/onsite-backups
      priority: 1
      backupSchedule: "*/5 * * * *" # every 5 minutes  env:
      env:
        - name: RESTIC_PASSWORD
          value: mySuperSecret123
        - name: AWS_ACCESS_KEY_ID
          value: minioadmin
        - name: AWS_SECRET_ACCESS_KEY
          value: minioadmin

    - target: s3:http://minio.backup-test:9000/offsite-backups
      priority: 2
      backupSchedule: "0 2 * * 1" # weekly
      env:
        - name: RESTIC_PASSWORD
          value: myCloudSecretKey123
        - name: AWS_ACCESS_KEY_ID
          value: minioadmin
        - name: AWS_SECRET_ACCESS_KEY
          value: minioadmin
